# AWSオブザーバビリティ学習用eコマースアプリ - バックエンドサービス一覧

## マイクロサービスアーキテクチャ一覧

| サービス名               | 実装技術      | データストア           | 主な機能                                                               | 実装フェーズ |
| ------------------------ | ------------- | ---------------------- | ---------------------------------------------------------------------- | ------------ |
| **商品カタログサービス** | Fargate (ECS) | RDS (PostgreSQL/MySQL) | ・商品情報の基本CRUD<br>・カテゴリ管理<br>・商品検索<br>・商品画像管理 | フェーズ1    |
| **ユーザーサービス**     | Lambda        | DynamoDB               | ・ユーザー登録・認証<br>・プロフィール管理<br>・お届け先住所管理       | フェーズ2    |
| **注文処理サービス**     | Fargate (ECS) | RDS (PostgreSQL/MySQL) | ・カート機能の永続化<br>・注文処理フロー<br>・支払い処理（模擬）       | フェーズ2    |
| **在庫管理サービス**     | Lambda        | DynamoDB               | ・在庫チェック・更新<br>・在庫不足アラート<br>・在庫データ同期         | フェーズ2    |
| **通知サービス**         | Lambda        | -                      | ・注文確認メール<br>・出荷通知<br>・在庫状況通知                       | フェーズ3    |

## サービス詳細

### 1. 商品カタログサービス

**技術スタック:**

- **計算リソース:** Fargate (ECS)
- **開発言語:** Go
- **データストア:** RDS (PostgreSQL/MySQL)
- **ストレージ:** S3 (商品画像)

**主な機能:**

- 商品情報の基本CRUD操作
- カテゴリ階層管理
- 商品検索インデックス管理
- 商品画像のアップロード/管理
- 商品レビュー管理

**API エンドポイント例:**

- `GET /products` - 商品一覧取得
- `GET /products/{id}` - 商品詳細取得
- `GET /categories` - カテゴリ一覧取得
- `GET /categories/{id}/products` - カテゴリ別商品取得
- `GET /products/search` - 商品検索

**オブザーバビリティポイント:**

- 商品詳細ページの閲覧数
- カテゴリ別のアクセス統計
- 検索クエリのパターン分析
- レスポンスタイムの測定

### 2. ユーザーサービス

**技術スタック:**

- **計算リソース:** Lambda
- **開発言語:** Node.js
- **データストア:** DynamoDB
- **認証:** Cognito統合

**主な機能:**

- ユーザー登録・ログイン処理
- ユーザープロフィール管理
- お届け先住所管理
- セッション管理
- アクセス権限管理

**API エンドポイント例:**

- `POST /users` - ユーザー登録
- `POST /auth/login` - ログイン
- `GET /users/{id}/profile` - プロフィール取得
- `PUT /users/{id}/profile` - プロフィール更新
- `GET /users/{id}/addresses` - 住所一覧取得
- `POST /users/{id}/addresses` - 住所追加

**オブザーバビリティポイント:**

- 登録完了率
- ログイン成功/失敗率
- セッション持続時間
- プロフィール更新頻度

### 3. 注文処理サービス

**技術スタック:**

- **計算リソース:** Fargate (ECS)
- **開発言語:** Go
- **データストア:** RDS (PostgreSQL/MySQL)
- **API管理:** API Gateway, ALB

**主な機能:**

- カート状態の永続化
- 注文フロー管理
- 支払い処理連携（模擬）
- 注文履歴管理

**API エンドポイント例:**

- `GET /carts/{userId}` - カート情報取得
- `POST /carts/{userId}/items` - カートに商品追加
- `DELETE /carts/{userId}/items/{itemId}` - カートから商品削除
- `POST /orders` - 注文作成
- `GET /orders/{id}` - 注文詳細取得
- `GET /users/{id}/orders` - ユーザーの注文履歴取得

**オブザーバビリティポイント:**

- カート放棄率
- 注文フロー完了率
- 支払い処理時間
- 注文処理のボトルネック特定

### 4. 在庫管理サービス

**技術スタック:**

- **計算リソース:** Lambda
- **開発言語:** Node.js
- **データストア:** DynamoDB
- **メッセージング:** SQS, SNS, EventBridge

**主な機能:**

- リアルタイム在庫チェック
- 在庫更新（注文確定時）
- 在庫不足アラート
- 入荷通知管理

**API エンドポイント例:**

- `GET /inventory/{productId}` - 在庫状況確認
- `PUT /inventory/{productId}` - 在庫数更新
- `POST /inventory/alerts` - 在庫アラート設定
- `POST /inventory/{productId}/notify` - 入荷通知登録

**オブザーバビリティポイント:**

- 在庫切れ発生率
- 在庫更新頻度
- 低在庫アラート頻度
- 入荷通知登録数

### 5. 通知サービス

**技術スタック:**

- **計算リソース:** Lambda
- **開発言語:** Node.js
- **メッセージング:** SNS, SQS, EventBridge
- **通知:** SES (メール送信)

**主な機能:**

- 注文確認メール送信
- 出荷通知
- 在庫状況通知
- システムアラート通知

**イベント連携例:**

- 注文確定イベント → 注文確認メール送信
- 出荷処理イベント → 出荷通知メール送信
- 入荷イベント → 在庫通知メール送信

**オブザーバビリティポイント:**

- メール送信成功率
- 通知処理時間
- イベント処理遅延
- 通知開封率

## サービス間連携パターン

1. **イベント駆動型連携:**
   - EventBridge を使用したサービス間のイベント連携
   - 各サービスがイベントを発行し、他サービスがそれをサブスクライブ
   - 非同期処理によるシステム全体の疎結合化

2. **API ゲートウェイ経由の同期連携:**
   - API Gateway を介したサービス間の REST API 呼び出し
   - クライアントからのリクエストに対するリアルタイム処理

3. **メッセージキューによる非同期連携:**
   - SQS を使用した非同期メッセージング
   - 処理のバッファリングとピーク負荷対策
   - 順序保証や再試行メカニズムの実装

4. **データの整合性維持:**
   - トランザクション境界の明確な定義
   - 最終的整合性モデルの適用
   - イベントソーシングによる状態追跡

## 拡張モジュール（フェーズ3-5）

1. **検索拡張サービス:**
   - OpenSearch Service による高度な全文検索
   - レコメンデーションエンジン

2. **分析サービス:**
   - ユーザー行動分析
   - 商品パフォーマンス分析
   - 売上レポート生成

3. **カオステスト用サービス:**
   - AWS Fault Injection Service との連携
   - 障害シミュレーション用エンドポイント
   - レジリエンス検証フレームワーク
