# エピック・ユーザーストーリー・ユースケースの関係 (本プロジェクトにおける考え方)

## 1. はじめに

このドキュメントは、本プロジェクト (AWSオブザーバビリティ学習用eコマースアプリ) におけるエピック、ユーザーストーリー、ユースケースの定義、役割、および相互関係について説明します。これらの要素は、要求定義から設計、開発、テストに至るプロセス全体を通じて、関係者間の共通理解を促進し、開発対象を明確にするために用いられます。

## 2. 各要素の定義と役割

### 2.1. エピック (Epic)

* **定義**: プロダクトの**大きなビジネス価値の塊**や、達成したい**戦略的な目標**を表します。通常、複数のスプリントにまたがる規模の、粗い粒度の要求です。
* **役割**:
  * プロダクトの全体像やロードマップを示す。
  * 投資対効果を議論する際の単位となる。
  * 関連するユーザーストーリーをグルーピングする。
* **本プロジェクトでの特徴**:
  * ビジネス機能領域 (例: `EP-SHOPPING`) と、横断的な技術基盤/関心事 (例: `EP-CROSSCUTTING-AUTH`, `EP-CROSSCUTTING-OBS`) の両方を定義しています。
  * 横断的エピックは、IDに `CROSSCUTTING` を含めることで識別しやすくしています。
* **例**: `EP-SHOPPING` (ショッピング体験), `EP-CUSTOMER-ENGAGEMENT` (顧客エンゲージメント), `EP-CROSSCUTTING-AUTH` (認証・認可基盤)

### 2.2. ユーザーストーリー (User Story)

* **定義**: **特定のペルソナ（役割）にとって価値のある**、独立してテスト・リリース可能な最小単位の機能要求です。「**[ペルソナ]** として、 **[目的]** のために、 **[機能]** がしたい/できる」という形式で記述します。通常、1スプリントで完了できるサイズを目指します。
* **役割**:
  * 開発バックログの基本単位となる。
  * スプリント計画や受け入れテストの基準となる。
  * ユーザー視点での価値を常に意識させる。
* **本プロジェクトでの特徴**:
  * ID体系 (`US-[ペルソナ略称]-[機能エリア略称]-[連番]`) により、誰のための、何の機能かが識別しやすくなっています。
  * ペルソナ（顧客、マネージャー、開発者、SRE、セキュリティ担当、ビジネスアナリスト）ごとに要求を明確化しています。
  * **実装ストーリー**と**利用ストーリー**を区別しています。
    * **実装ストーリー**: 主に開発者(`DEV`)やSRE(`SRE`)向け。横断的な基盤の構築や、技術的な仕組みの導入自体に価値を置くストーリー（例: `US-DEV-AUTH-IMPL-01` 認証基盤実装）。`(実装)` と明記。**目的（Why）**には、将来の効率性、保守性、非機能要件への貢献などを記述します。
    * **利用ストーリー**: すべてのペルソナ向け。特定の機能を使って目的を達成するストーリー（例: `US-CUST-BROWSE-01` 商品閲覧、`US-SRE-OBS-ALERT-01` アラート受信）。`(利用)` と明記（または省略）。
  * 実装ストーリーは、関連する利用ストーリーを意識し、過不足ない実装となるよう連携して扱います。
* **例**:
  * `US-CUST-BROWSE-01`: サイト訪問者として、商品一覧を閲覧できるようにしたい。
  * `US-MGR-PROD-01`: マネージャーとして、新しい商品を登録できるようにしたい。
  * `US-DEV-AUTH-IMPL-01`: (実装) 開発者として、共通認証基盤をセットアップし、基本認証機能を組み込みたい。
  * `US-SRE-OBS-ALERT-01`: (利用) SREとして、システムの異常を検知し、実用的なアラートを受け取りたい。

### 2.3. ユースケース (Use Case)

* **定義**: 特定の目標を達成するために、**システムがアクター（ペルソナや外部システム）とどのように相互作用するか**を記述したものです。具体的な操作手順、システムの応答、代替フロー、例外フローを含みます。
* **役割**:
  * ユーザーストーリーで定義された「何がしたいか」に対して、「**システムがどのように振る舞うか**」を具体化する。
  * 複雑なインタラクションやビジネスロジックを明確にする。
  * 画面設計やAPI設計のインプットとなる。
  * テストシナリオを作成するための基礎となる。
* **本プロジェクトでの特徴**:
  * ID体系 (`UC-[ペルソナ略称]-[機能エリア略称]-[連番]`) を採用。
  * 各ユースケースシナリオには、関連するユーザーストーリーIDを明記し、トレーサビリティを確保します。
  * オブザーバビリティ関連など、ペルソナによって目的が大きく異なる場合は、ユースケースも分割して定義しています (例: `UC-DEV-OBS-DEBUG-01` vs `UC-SRE-OBS-INCIDENT-INVESTIGATE-01`)。
  * すべてのユーザーストーリーに必ずしも詳細なユースケースが必要ではなく、特にインタラクションが複雑な場合や、関係者間で認識齟齬が発生しやすい場合に重点的に記述します。
* **例**:
  * `UC-CUST-CHECKOUT-01`: 注文処理
  * `UC-MGR-ORDER-02`: 出荷処理
  * `UC-SRE-OBS-ALERT-01`: 異常検知とアラート対応

## 3. 関係性のまとめ

* **階層と分割**: エピックは大きな価値の塊であり、それを実現可能な単位に分割したものがユーザーストーリーです。

    ```mermaid
    graph TD
        subgraph EP-SHOPPING [ショッピング体験]
            US1(US-CUST-BROWSE-01<br/>商品一覧閲覧)
            US2(US-CUST-CART-01<br/>カート追加)
            US3(US-CUST-CHECKOUT-01<br/>チェックアウト)
            US4(...)
        end
    ```

* **詳細化と補完**: ユーザーストーリーは「What/Why」を、ユースケースは「How (System Behavior)」を記述し、相互に補完します。一つのユースケースが複数のユーザーストーリーに関連することもあります（例: ログイン機能 `UC-CUST-AUTH-02` は多くの機能の前提となる）。

    ```mermaid
    graph TD
        subgraph User Story & Use Case
            US(US-CUST-CHECKOUT-01<br/>チェックアウトしたい) --> UC(UC-CUST-CHECKOUT-01<br/>注文処理ユースケース);
            subgraph UC Details
                direction LR
                Step1[1. カート表示] --> Step2[2. 配送先選択];
                Step2 --> Step3[3. 支払方法選択];
                Step3 --> Step4[4. 注文確定];
                Step4 --> Step5[5. 完了表示];
            end
        end
    ```

* **ペルソナ中心**: 本プロジェクトでは、ユーザーストーリーとユースケースは、特定のペルソナの視点やニーズに基づいて定義・分類されています。これにより、誰にとっての価値なのかが常に明確になります。

    ```mermaid
    graph TD
        subgraph EP-CROSSCUTTING-OBS [オブザーバビリティ]
            P1(ペルソナ: 開発者 DEV) --> US_DEV(US-DEV-OBS-DEBUG-01<br/>デバッグ利用)
            P1 --> US_DEV_IMPL(US-DEV-OBS-LOG-IMPL-01<br/>ログ実装)
            P2(ペルソナ: SRE) --> US_SRE(US-SRE-OBS-ALERT-01<br/>アラート利用)
            P2 --> US_SRE_IMPL(US-SRE-OBS-IMPL-01<br/>インフラ実装)
            P3(ペルソナ: セキュリティ SEC) --> US_SEC(US-SEC-OBS-AUDIT-01<br/>監査利用)

            US_DEV --> UC_DEV(UC-DEV-OBS-DEBUG-01<br/>開発ログ分析UC)
            US_SRE --> UC_SRE(UC-SRE-OBS-ALERT-01<br/>アラート対応UC)
            US_SEC --> UC_SEC(UC-SEC-OBS-AUDIT-01<br/>セキュリティ監査UC)
        end
    ```

* **粒度**: エピック (数ヶ月〜年単位) > ユーザーストーリー (数日〜1スプリント) > ユースケースのステップ (操作単位)

## 4. 運用上の注意点

* これらの定義や関係性はガイドラインであり、プロジェクトの状況に応じて柔軟に運用します。
* 重要なのは、ドキュメントを作成すること自体ではなく、これらのツールを通じて関係者間のコミュニケーションを円滑にし、共通理解を形成することです。
* ユーザーストーリーやユースケースは、開発が進むにつれて詳細化されたり、変更されたりする可能性があります。常に最新の状態を保つように努めます。
