# 1. AWSオブザーバビリティ学習用eコマースアプリ実装計画

- [1. AWSオブザーバビリティ学習用eコマースアプリ実装計画](#1-awsオブザーバビリティ学習用eコマースアプリ実装計画)
  - [1.1. プロジェクト概要](#11-プロジェクト概要)
    - [1.1.1. 概要](#111-概要)
    - [1.1.2. プロジェクトの目的](#112-プロジェクトの目的)
    - [1.1.3. 技術スタック](#113-技術スタック)
  - [1.2. 実装フェーズの概要](#12-実装フェーズの概要)
    - [1.2.1. フェーズ1: 開発環境のセットアップとプロジェクト骨組み構築（2週間）](#121-フェーズ1-開発環境のセットアップとプロジェクト骨組み構築2週間)
    - [1.2.2. フェーズ2: バックエンド実装（3週間）](#122-フェーズ2-バックエンド実装3週間)
    - [1.2.3. フェーズ3: フロントエンド実装（3週間）](#123-フェーズ3-フロントエンド実装3週間)
    - [1.2.4. フェーズ4: AWS環境へのデプロイとオブザーバビリティ強化（2週間）](#124-フェーズ4-aws環境へのデプロイとオブザーバビリティ強化2週間)
    - [1.2.5. フェーズ5: OpenTelemetryアプローチの実装（2週間）](#125-フェーズ5-opentelemetryアプローチの実装2週間)
    - [1.2.6. フェーズ6: オブザーバビリティ比較と最終調整（2週間）](#126-フェーズ6-オブザーバビリティ比較と最終調整2週間)
  - [1.3. MVP機能の概要](#13-mvp機能の概要)
    - [1.3.1. 顧客向け機能](#131-顧客向け機能)
    - [1.3.2. 管理者向け機能](#132-管理者向け機能)
    - [1.3.3. オブザーバビリティ機能](#133-オブザーバビリティ機能)
  - [1.4. 期待される学習成果](#14-期待される学習成果)
  - [1.5. AWS環境のコスト最適化戦略](#15-aws環境のコスト最適化戦略)
  - [1.6. ログ実装のベストプラクティス](#16-ログ実装のベストプラクティス)
  - [1.7. トレース実装のベストプラクティス](#17-トレース実装のベストプラクティス)
  - [1.8. メトリクス実装のベストプラクティス](#18-メトリクス実装のベストプラクティス)
  - [1.9. ダッシュボード設計のガイドライン](#19-ダッシュボード設計のガイドライン)
  - [1.10. アラート設定のガイドライン](#110-アラート設定のガイドライン)

## 1.1. プロジェクト概要

このeコマースアプリケーションは、AWSオブザーバビリティパターンの学習を目的としたMVP(Minimum Viable Product)アプリケーションです。オブザーバビリティの2つのアプローチ（AWS SDK v2とOpenTelemetry）を実装・比較することで、それぞれの特性や使い方を学びます。

### 1.1.1. 概要

オブザーバビリティとは、システムの内部状態を外部からの観測によって理解する能力です。以下の「3本の柱」から構成されています：

1. **ログ（Logs）**：システムで何が起きたかの記録
2. **メトリクス（Metrics）**：システムの状態を数値で表現したもの
3. **トレース（Traces）**：リクエストがシステム内をどのように流れるかの追跡

### 1.1.2. プロジェクトの目的

1. Go言語とNext.jsによるフルスタックeコマースアプリケーションの開発
2. AWS環境でのアプリケーション運用とオブザーバビリティの実装
3. AWS SDK v2とOpenTelemetryの2つのアプローチによるオブザーバビリティの比較と学習

### 1.1.3. 技術スタック

**フロントエンド:**

- Next.js (Reactベースのフレームワーク)
- TypeScript
- TailwindCSS
- AWS S3 + CloudFront (静的アセットホスティング)

**バックエンド:**

- Go言語 (Echo Webフレームワーク)
- sqlboiler (MySQLに特化したORM)
- OpenAPI
- slog (構造化ログ)
- AWS Fargate (ECS)
- MySQL (RDS)
- AWS ALB (Application Load Balancer)

**オブザーバビリティ:**

1. AWS SDK v2アプローチ
   - X-Ray SDK for Go v2
   - CloudWatch SDK v2
   - slog + CloudWatch Logs

2. OpenTelemetryアプローチ
   - OpenTelemetry Go SDK
   - AWS Distro for OpenTelemetry (ADOT)
   - X-Ray Exporter

## 1.2. 実装フェーズの概要

### 1.2.1. フェーズ1: 開発環境のセットアップとプロジェクト骨組み構築（2週間）

1. **開発環境構築**
   - Docker Composeによるローカル開発環境構築
   - Go開発環境のセットアップ（air、テスト、lint）
   - Next.js開発環境のセットアップ
   - LocalStackによるローカルAWSサービスエミュレーション

2. **プロジェクト基本構造の構築**
   - バックエンドのディレクトリ構造設計
   - API定義（OpenAPI仕様）
   - データベーススキーマとマイグレーション設計
   - フロントエンドの基本レイアウトとルーティング設計

3. **CI/CD初期設定**
   - GitHub Actions基本設定
   - Terraformによる基本インフラ定義

### 1.2.2. フェーズ2: バックエンド実装（3週間）

1. **データベースモデル実装**
   - MySQLスキーマの実装
   - sqlboilerによるモデル生成
   - データマイグレーションスクリプト

2. **コアサービスの実装**
   - 商品カタログサービス実装（`/api/products/*`）
   - 在庫管理サービス実装（`/api/inventory/*`）
   - 注文処理サービス実装（`/api/orders/*`）
   - 管理者認証サービス実装（`/api/auth/*`）

3. **オブザーバビリティ基盤の初期実装（AWS SDK v2アプローチ）**
   - slogによる構造化ログ実装
   - X-Ray SDK初期統合
   - 基本メトリクス収集設定、CloudWatch Metricsへのメトリクス送信
   - アラートとダッシュボードの作成

### 1.2.3. フェーズ3: フロントエンド実装（3週間）

1. **Next.jsの基本コンポーネント実装**
   - レイアウトコンポーネント（ヘッダー、フッター、ナビゲーション）
   - 共通UIコンポーネント
   - API通信用のカスタムフック

2. **顧客向け画面の実装**
   - ホーム画面（SCR-01）
   - 商品一覧画面（SCR-02）
   - 商品詳細画面（SCR-03）
   - カート画面（SCR-04）
   - 注文手続き画面（SCR-05）
   - 注文完了画面（SCR-06）

3. **管理者向け画面の実装**
   - 管理者ログイン画面、ダッシュボード
   - 商品管理画面、在庫管理画面

### 1.2.4. フェーズ4: AWS環境へのデプロイとオブザーバビリティ強化（2週間）

1. **AWSインフラの構築**
   - Terraformによる本番環境構築
   - AWS Fargate、RDS、CloudFront、S3の設定
   - ALBセットアップとルーティング設定

2. **オブザーバビリティの本格実装**
   - X-Ray詳細設定
   - CloudWatch Dashboardの構築
   - アラート・通知の設定

3. **初期パフォーマンステストと最適化**

   - オブザーバビリティ設定の最適化
   - ダッシュボードの強化

### 1.2.5. フェーズ5: OpenTelemetryアプローチの実装（2週間）

1. **OpenTelemetry基盤の構築**
2. **OTELコンポーネントの実装**
3. **AWS X-Ray Exporterの設定**

### 1.2.6. フェーズ6: オブザーバビリティ比較と最終調整（2週間）

1. **両アプローチの比較と分析**
2. **最終調整と文書化**

## 1.3. MVP機能の概要

### 1.3.1. 顧客向け機能

- 商品一覧・詳細表示
- カテゴリー別商品表示
- 在庫状況表示
- カート機能（商品追加/削除）
- 簡易注文処理

### 1.3.2. 管理者向け機能

- 商品情報管理（CRUD操作）
- 商品登録機能
- 在庫レベル監視
- 在庫更新

### 1.3.3. オブザーバビリティ機能

- 構造化ログ収集
- 基本メトリクス収集
- 分散トレース実装
- ヘルスチェックとアラート
- 基本ダッシュボード

## 1.4. 期待される学習成果

1. Goを使用したバックエンド開発とNext.jsを使用したフロントエンド開発の実践的知識
2. AWS環境でのマイクロサービスアーキテクチャの設計と実装経験
3. オブザーバビリティの重要性と実装方法の理解
4. AWS SDK v2とOpenTelemetryの違いと使い分けについての知見
5. Terraformを用いたInfrastructure as Codeの実践

## 1.5. AWS環境のコスト最適化戦略

1. ヘルスチェックのための稼働時間最適化（業務時間のみの稼働）
2. リソースサイジングの最適化（Fargate: 0.5 vCPU、1GB RAM、RDS: db.t3.micro）
3. CloudWatchとX-Rayのコスト削減（最適なサンプリングレート設定）
4. 開発終了後の自動シャットダウン

これらのフェーズを通じて、MVPの開発とAWSオブザーバビリティパターンの学習を進めていきます。

## 1.6. ログ実装のベストプラクティス

- 統一された構造化ログフォーマットを使用する
- コンテキスト情報（リクエストID、トレースIDなど）を含める
- 適切なログレベルを使用する（DEBUG、INFO、WARN、ERROR）
- 機密情報をログに含めない

## 1.7. トレース実装のベストプラクティス

- サービス間の依存関係を可視化する
- パフォーマンスボトルネックを特定する
- エラーの根本原因を特定する
- サンプリングレートを適切に設定する

## 1.8. メトリクス実装のベストプラクティス

- RED（Request Rate、Error Rate、Duration）パターンを実装する
- ビジネスメトリクスを追跡する
- リソース使用率を監視する
- 異常検出を設定する

## 1.9. ダッシュボード設計のガイドライン

- 重要なメトリクスを一目で確認できるように配置する
- 関連するメトリクスをグループ化する
- トレンドを可視化する
- 異常値を強調表示する

## 1.10. アラート設定のガイドライン

- 意味のあるアラートを設定する（ノイズを避ける）
- アクション可能なアラートを設定する
- 適切なしきい値を設定する
- エスカレーションパスを定義する
